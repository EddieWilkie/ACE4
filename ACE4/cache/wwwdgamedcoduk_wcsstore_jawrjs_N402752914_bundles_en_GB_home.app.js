var App=App||{};App.EMS=App.EMS||{};App.EMS.AutoScrollBanner=(function(node){var $node=$(node),$products=$node.find("ul.products").find("li.productItem"),$pagination=$node.find("ol.navigation"),$control=$pagination.find("li.control a"),count=$products.length,delay=parseInt(Salmon.Global.PageContext.CAROUSEL_TIMER)*1000,interval=null,animating=false;currentPage=0,showClass="show",hideClass="hide",activeClass="active",speed="fast",paused=false;init();function init(){$pagination.removeClass("hide");for(var i=0;i<count;i++){if(i===0){show($products[i]);$($pagination.find("li.page").get(0)).addClass(activeClass);}else{hide($products[i]);}}bindPaginationEvents();start();}function bindPaginationEvents(){$control.bind("click",function(){if(!paused){$(this).removeClass("pause").addClass("play");stop();}else{stop();$(this).removeClass("play").addClass("pause");start();}return false;});$pagination.find("li.page a").bind("click",function(){clearInterval(interval);activateItem(parseInt($(this).data('index'))-1,true);paused=true;$control.removeClass("pause").addClass("play");return false;});}function start(){paused=false;interval=setInterval((function(){activateItem((currentPage<count-1)?currentPage+1:0);}),delay);}function stop(){paused=true;clearInterval(interval);}function show(item){$(item).show().addClass(showClass).removeClass(hideClass);return $(item);}function hide(item){$(item).hide().addClass(hideClass).removeClass(showClass).css("zIndex",1);return $(item);}function activateItem(index,manual){var ignorePause=manual||false;if(!animating&&index!==currentPage&&(!paused||ignorePause)){var $item=$($products.get(currentPage)),$newItem=$($products.get(index));show($newItem).css("zIndex",0);animating=true;$item.fadeOut(speed,function(){$newItem.css("zIndex",1);hide(this);currentPage=index;updatePagination();animating=false;});}}function updatePagination(){$pagination.find("li.page").each(function(index){if(index===currentPage){$(this).addClass(activeClass);}else{$(this).removeClass(activeClass);}});}});var App=App||{};App.EMS=App.EMS||{};App.EMS.EMSCarousel=new(function(){});var App=App||{};App.EMS=App.EMS||{};App.EMS.Controller=new(function(){var $topReviews;$(init);function init(){var $content=$("#content");var $ratings=$content.find("div.productsESpot").find("li.review").removeClass("hide");new App.Global.Ratings($ratings);if(App.Global.Pluck.Check()){$topReviews=$content.find("div.mostReviewed").find("div.topReview");if($topReviews.length>0){var requests=new Array();for(var i=0;i<$topReviews.length;i++){var request=new PluckSDK.ReviewsPageRequest(),articleKey=new PluckSDK.ExternalResourceKey({Key:$topReviews[i].getAttribute("rel")});request.ItemsPerPage=1;request.OneBasedOnPage=1;request.ReviewedKey=articleKey;request.SortType=new PluckSDK.ScoreSort({SortOrder:"Descending"});requests.push(request);}PluckSDK.SendRequests(requests,showTopUserReview);}}}function showTopUserReview(responses){if(responses.length>0){if(responses[0].Items.length>0){showTopUserReviewSummary(responses[0].Items);}}}function showTopUserReviewSummary(reviews){for(var i=0;i<$topReviews.length;i++){var $topReview=$($topReviews[i]),review=reviews[i];$topReview.removeClass("hide").find("div.user").text(reviews[i].ReviewedBy.DisplayName);var reviewBody=review.Body;if(reviewBody.length>100){reviewBody="&#8216;"+reviewBody.substring(0,97)+"&#8217;&hellip;"}else{reviewBody="&#8216;"+reviewBody+"&#8217;"}$topReview.find("p").html(reviewBody);$topReview.find("div.rating").addClass("rating"+Math.floor(review.Rating));}}});App=App||{};App.Homepage=App.Homepage||{};App.Homepage.Recommendations=new(function(){$(document).ready(function(){var rec={zoneId:"Home_1",categoryId:"_TS_"}});});